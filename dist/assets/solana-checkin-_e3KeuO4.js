(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function r(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(t){if(t.ep)return;t.ep=!0;const a=r(t);fetch(t.href,a)}})();const Z="modulepreload",J=function(e){return"/"+e},O={},I=function(n,r,c){let t=Promise.resolve();if(r&&r.length>0){let f=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),l=s?.nonce||s?.getAttribute("nonce");t=f(r.map(d=>{if(d=J(d),d in O)return;O[d]=!0;const u=d.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const o=document.createElement("link");if(o.rel=u?"stylesheet":Z,u||(o.as="script"),o.crossOrigin="",o.href=d,l&&o.setAttribute("nonce",l),document.head.appendChild(o),u)return new Promise((p,y)=>{o.addEventListener("load",p),o.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return t.then(s=>{for(const l of s||[])l.status==="rejected"&&a(l.reason);return n().catch(a)})},_=[{key:"bsc",type:"evm",chainIdHex:"0x38",displayName:"BNB Chain"},{key:"opbnb",type:"evm",chainIdHex:"0xcc",displayName:"opBNB"},{key:"eth",type:"evm",chainIdHex:"0x1",displayName:"Ethereum"},{key:"base",type:"evm",chainIdHex:"0x2105",displayName:"Base"}];function T(e){const n=String(e||"").toLowerCase().trim();return n?n==="mainnet-beta"||n==="mainnet"||n==="mainnetbeta"?"mainnet":n==="testnet"?"testnet":"devnet":"devnet"}const M={mainnet:"YourSolanaMainnetProgramId",devnet:"HDNJ2F8CMHksj2EzuutDZiHrduCyi4KLZGabpdCs5BfZ",testnet:void 0},q=window?.ENV?.SOLANA_PROGRAM_ID||"HDNJ2F8CMHksj2EzuutDZiHrduCyi4KLZGabpdCs5BfZ",R=T(localStorage.getItem("solanaCluster")||window?.ENV?.SOLANA_CLUSTER||"devnet"),Q=M[R]||q,w={key:"solana",type:"solana",cluster:R,endpointByCluster:{mainnet:"https://api.mainnet-beta.solana.com",devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com"},programId:Q,idlPath:"/solana-idl.json",explorerByCluster:{mainnet:"https://explorer.solana.com",devnet:"https://explorer.solana.com?cluster=devnet",testnet:"https://explorer.solana.com?cluster=testnet"}},x=localStorage.getItem("currentChainKey")||"bsc";let A=x==="solana"?w:_.find(e=>e.key===x)||_[0];function X(e){e==="solana"?A=w:A=_.find(n=>n.key===e)||_[0],localStorage.setItem("currentChainKey",e),window.dispatchEvent(new CustomEvent("chainChanged",{detail:{key:e}}))}function D(){return A?.type==="solana"}function ee(){return w.endpointByCluster[w.cluster]||w.endpointByCluster.devnet}function b(e){return`${w.explorerByCluster[w.cluster]||w.explorerByCluster.devnet}/tx/${e}`}function te(e){const n=T(e);w.cluster=n,localStorage.setItem("solanaCluster",n);const r=M[n]||window?.ENV?.SOLANA_PROGRAM_ID||w.programId;w.programId=r,window.dispatchEvent(new CustomEvent("solanaClusterChanged",{detail:{cluster:n}}))}window.setCurrentChain=X;window.isSolanaSelected=D;window.setSolanaCluster=te;const S={provider:null,connected:!1,pubkey:null};function ne(){return window?.solana?.isPhantom&&window.solana||window?.phantom?.solana||window?.solflare||window?.backpack?.solana||window?.solana||null}async function oe(){if(S.provider=ne(),!S.provider)throw new Error("No Solana wallet found. Install Phantom/Solflare/Backpack.");const e=await S.provider.connect();return S.connected=!0,S.pubkey=e.publicKey?.toString?.()||S.provider.publicKey?.toString?.(),S.pubkey}const k="checkin",v="user_pda";async function re(){try{return await I(()=>import("https://unpkg.com/@solana/web3.js@1.95.3/lib/index.browser.esm.js"),[])}catch{try{return await I(()=>import("https://cdn.jsdelivr.net/npm/@solana/web3.js@1.95.3/lib/index.browser.esm.js"),[])}catch{return await I(()=>import("https://esm.sh/@solana/web3.js@1.95.3?bundle"),[])}}}async function B(e,n,r,c){const t="processed",a="confirmed",{blockhash:s,lastValidBlockHeight:l}=await n.getLatestBlockhash(t);try{e.feePayer=r}catch{}e.recentBlockhash=s,await new Promise(d=>setTimeout(d,1200));let f;if(typeof window.solana?.signAndSendTransaction=="function"){const d=await window.solana.signAndSendTransaction(e,{preflightCommitment:"processed",skipPreflight:!1});f=d?.signature||d}else{if(!window.solana?.signTransaction)throw new Error("Phantom wallet not available");const d=await window.solana.signTransaction(e);f=await n.sendRawTransaction(d.serialize(),{skipPreflight:!1,preflightCommitment:"processed"})}return await n.confirmTransaction({signature:f,blockhash:s,lastValidBlockHeight:l},a),f}async function ae(){const e=await fetch(w.idlPath,{cache:"no-cache"});if(!e.ok)throw new Error(`Failed to load IDL from ${w.idlPath}`);return await e.json()}async function H(e){const r=new TextEncoder().encode(`global:${e}`),c=await crypto.subtle.digest("SHA-256",r);return new Uint8Array(c).slice(0,8)}function se(e=[],n){const r=(e||[]).find(l=>/Error Code:/i.test(l));if(!r)return null;const c=(r.match(/Error Code:\s*([A-Za-z0-9_]+)/i)||[])[1],t=(r.match(/Error Number:\s*(0x[0-9a-fA-F]+)/i)||[])[1],a=t?parseInt(t,16):void 0,s=(n?.errors||[]).find(l=>l.code===a||l.name===c);return s?{code:s.code,name:s.name,msg:s.msg}:{code:a,name:c}}function U(e,n,r,c){const{PublicKey:t,SystemProgram:a,SYSVAR_RENT_PUBKEY:s,SYSVAR_CLOCK_PUBKEY:l,SYSVAR_INSTRUCTIONS_PUBKEY:f}=n,d={},u=(m,o)=>String(m||"").toLowerCase()===String(o||"").toLowerCase();for(const m of e.accounts){const o=String(m.name||"");if(m.isSigner){d[o]=r;continue}if(["authority","owner","user","payer","signer","wallet"].some(p=>u(o,p))){d[o]=r;continue}if(u(o,"systemProgram")||u(o,"system_program")||u(o,"system")){d[o]=a.programId;continue}if(u(o,"rent")||u(o,"rentSysvar")||u(o,"sysvarRent")){s&&(d[o]=s);continue}if(u(o,"clock")||u(o,"clockSysvar")||u(o,"sysvarClock")){l&&(d[o]=l);continue}if(u(o,"instructions")||u(o,"sysvarInstructions")||u(o,"instructionsSysvar")){f&&(d[o]=f);continue}if(m.pda?.seeds?.length){const p=m.pda.seeds.map(h=>{if(h.kind==="const")return Buffer.from(h.value,"utf8");if(h.kind==="account"&&["authority","owner","user","payer","signer","wallet"].some(E=>u(h.path,E)))return r.toBuffer();throw new Error(`Unsupported PDA seed for "${o}": ${JSON.stringify(h)}`)}),[y]=t.findProgramAddressSync(p,new t(c));d[o]=y;continue}if(!m.isOptional)throw console.warn("[unmapped account]",m),new Error(`Cannot map account "${o}" from IDL – please wire it manually.`)}return d}function K(e,n){const r=c=>String(c||"").toLowerCase();return e.accounts.filter(c=>n[c.name]).map(c=>{const t=r(c.name);let a=!!c.isSigner,s=!!c.isMut;return["authority","owner","user","payer","signer","wallet"].includes(t)&&(a=!0),(t.endsWith("_pda")||t.includes("pda"))&&(s=!0),{pubkey:n[c.name],isSigner:a,isWritable:s}})}function ie(e){return(e.instructions||[]).filter(r=>{const c=(r.accounts||[]).some(a=>a.name?.toLowerCase?.()===v),t=/init/i.test(r.name)||/initialize/i.test(r.name);return c&&t})[0]||null}async function ce(e,n,r,c){const t=U(e,n,r,c);console.log(`[build ${e.name}] accountsMap`,Object.fromEntries(Object.entries(t).map(([l,f])=>[l,f.toString()])));const a=K(e,t);console.table(a.map(l=>({pubkey:l.pubkey.toString(),isSigner:l.isSigner,isWritable:l.isWritable})));const s=await H(e.name);return{keys:a,data:s}}function $(){const e=l=>Number(localStorage.getItem(l)||0),n=e("current_streak"),r=e("total_checkins"),c=30,t=document.getElementById("currentStreak"),a=document.getElementById("totalCheckIns"),s=document.getElementById("nextReward");t&&(t.textContent=`${n} days`),a&&(a.textContent=r),s&&(s.textContent=`${c}`)}function F(){if(!D())throw new Error("Current chain is not Solana. Switch chain first.")}async function le(){window.__i3_sol_success_fired=!1,F(),document.getElementById("checkin-modal")?.classList?.remove("hidden");try{$()}catch{}try{const e=JSON.parse(localStorage.getItem("checkin_status_SOLANA")||"null"),n=new Date().toISOString().slice(0,10);if(e?.checked&&e?.date===n){const r=document.getElementById("executeCheckInBtn");r&&(r.disabled=!0,r.textContent="Already Checked In Today",r.style.opacity="0.6",r.style.cursor="not-allowed")}}catch{}}async function de(e={}){F();const{onStatus:n,onError:r,onSuccess:c}=e;try{const t=await oe();n?.(`Wallet: ${t}`);const a=await ae(),s=await re(),{Connection:l,PublicKey:f,Transaction:d,TransactionInstruction:u}=s,m=new l(ee(),"confirmed"),o=new f(w.programId),p=new f(t),y=a.instructions.find(i=>i.name===k)||a.instructions.find(i=>i.name?.toLowerCase?.()===k);if(!y)throw new Error(`No instruction "${k}" found in IDL`);const h=U(y,s,p,o);console.log("[accountsMap]",Object.fromEntries(Object.entries(h).map(([i,C])=>[i,C.toString()])));const E=h[v];if(!await m.getAccountInfo(E)){n?.("User account not initialized. Running init…");const i=ie(a);if(!i)throw new Error(`Account "${v}" not initialized and no init instruction found in IDL`);const{keys:C,data:Y}=await ce(i,s,p,o),z=new u({programId:o,keys:C,data:Y}),G=new d().add(z),L=await B(G,m,p,s);console.log("[init] done:",L,b(L))}const N=K(y,h);console.table(N.map(i=>({pubkey:i.pubkey.toString(),isSigner:i.isSigner,isWritable:i.isWritable})));const V=await H(y.name),j=new u({programId:o,keys:N,data:V}),W=new d().add(j);n?.("Sending transaction...");const g=await B(W,m,p,s);if(n?.("Confirming..."),window.__i3_sol_success_fired){console.warn("[solana] success path already handled (skip duplicate).");const i=b(g);return c?.({txSig:g,url:i}),{txSig:g,url:i}}window.__i3_sol_success_fired=!0;try{await window.walletManager?.dailyCheckin?.({skipLocalGate:!0})}catch(i){console.warn("[solana-checkin] dailyCheckin failed:",i)}try{localStorage.setItem("checkin_status_SOLANA",JSON.stringify({checked:!0,date:new Date().toISOString().slice(0,10)}));const i=document.getElementById("executeCheckInBtn");i&&(i.disabled=!0,i.textContent="Already Checked In Today",i.style.opacity="0.6",i.style.cursor="not-allowed"),window.dispatchEvent(new CustomEvent("i3:checkin-updated",{detail:{chain:"SOLANA"}}))}catch(i){console.warn("[solana] mark checked-in locally failed:",i)}try{$()}catch{}window.walletManager?.updateUI?.();try{const i=await m.getTransaction(g,{commitment:"confirmed",maxSupportedTransactionVersion:0});if(i?.meta?.logMessages){console.log(`[on-chain logs]
`+i.meta.logMessages.join(`
`));const C=se(i.meta.logMessages,a);C&&console.warn("[anchor-error@chain]",C)}}catch{}const P=b(g);return c?.({txSig:g,url:P}),{txSig:g,url:P}}catch(t){throw console.error(t),r?.(t),t}}window.openSolanaCheckinModal=le;window.executeSolanaCheckin=e=>de(e);export{I as _};
